<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestion de Cambios</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="css/style.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">


</head>

<body>


  <!-- Sidebar -->
  <div class="sidebar d-flex flex-column">
    <h4 class="text-center mb-4">Panel de Administrador</h4>
    <a href="dashboard_admin.html" class="nav-link">Inicio</a>
    <a href="problemas_admin.html" class="nav-link">Problemas</a>
    <a href="incidencias_admin.html" class="nav-link">Incidencias</a>
    <a href="cambios_admin.html" class="nav-link">Cambios</a>
    <a href="configuraciones.html" class="nav-link">Configuraciones</a>
    <a href="#" class="nav-link mt-auto" onclick="cerrarSesion()">Cerrar sesión</a>
  </div>

  <!-- Barra fija superior -->
  <div class="barra-coppel">
    <img src="imagenes/coppel.png" alt="Logo Coppel"  />
  </div>
  
    
  
  <div class="main-content">
    <h2 class="text-center mb-4">Gestión de Cambios (RFC)</h2>

    <div class="d-flex justify-content-end align-items-center mb-3">
      <label for="filtroEstado" class="me-2 fw-bold text-primary">Filtrar por estado:</label>
      <select id="filtroEstado" class="form-select w-auto">
        <option value="Todos">Todos</option>
        <option value="Pendiente">Pendiente</option>
        <option value="Aprobada">Aprobada</option>
        <option value="Rechazada">Rechazada</option>
      </select>
    </div>
    <div id="mensajeCambioAdmin"></div>

    <div class="table-responsive">
      <table class="table table-bordered text-center" id="tablaSolicitudesCambio">
        <thead>
          <tr>
            <th>#RFC</th>
            <th >(ID) - Título Incidencia</th>
            <th >Técnico</th>
            <th >Pieza Solicitada</th>
            <th>Estado</th>
            <th >Fecha Solicitud</th>
          </tr>
        </thead>
        <tbody id="listaSolicitudesCambio">
                    <!-- Aquí se insertarán las filas dinámicamente con JS -->
        </tbody>
      </table>
    </div>
  </div>
  
  

<!-- Modal Detalles de la Solicitud de Cambio -->
<div class="modal fade" id="modalDetalles" tabindex="-1" aria-labelledby="modalDetallesLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg">
    <div class="modal-content shadow">

      <form id="formModalDetalles">

        <!-- Campo oculto -->
        <input type="hidden" id="idCambioSeleccionado" name="idCambioSeleccionado">

        <!-- Encabezado -->
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="modalDetallesLabel"><i class="bi bi-pencil-square"></i> Detalles de la Solicitud</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>

        <!-- Cuerpo -->
        <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
          <div class="row g-3">

            <div class="col-md-6">
              <label for="modalTitulo" class="form-label fw-bold">Título</label>
              <input type="text" class="form-control" id="modalTitulo" disabled>
            </div>

            <div class="col-md-6">
              <label for="modalEquipo" class="form-label fw-bold">Equipo</label>
              <input type="text" class="form-control" id="modalEquipo" disabled>
            </div>

            <div class="col-md-6">
              <label for="modalPieza" class="form-label fw-bold">Pieza</label>
              <input type="text" class="form-control" id="modalPieza" disabled>
            </div>

            <div class="col-md-6">
              <label for="modalEstado" class="form-label fw-bold">Estado</label>
              <select id="modalEstado" class="form-select">
                <option value="Aprobada">Aprobada</option>
                <option value="Rechazada">Rechazada</option>
              </select>
            </div>

            <div class="col-md-12">
              <label for="modalMotivo" class="form-label fw-bold">Motivo</label>
              <input type="text" class="form-control" id="modalMotivo" disabled>
            </div>

            <div class="col-md-12">
              <label for="modalDiagnostico" class="form-label fw-bold">Diagnóstico</label>
              <input type="text" class="form-control" id="modalDiagnostico" disabled>
            </div>

            <div class="col-md-6">
              <label for="modalFechaSolicitud" class="form-label fw-bold">Fecha de Solicitud</label>
              <input type="text" class="form-control" id="modalFechaSolicitud" disabled>
            </div>

            <div class="col-md-6">
              <label for="modalUbicación" class="form-label fw-bold">Ubicación</label>
              <input type="text" class="form-control" id="modalUbicación" disabled>
            </div>

            <div class="col-md-12">
              <label for="modalArea" class="form-label fw-bold">Área</label>
              <input type="text" class="form-control" id="modalArea" disabled>
            </div>

          </div>

          <div id="mensaje" class="mt-3"></div>
        </div>

        <!-- Footer -->
        <div class="modal-footer justify-content-center">
          <button type="button" class="btn btn-primary px-4" id="btnGuardarCambiosModal" onclick="guardarCambio()">
            <i class="bi bi-save"></i> Guardar Cambios
          </button>
        </div>

      </form>

    </div>
  </div>
</div>



  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/cambiosAdmin.js"></script>
  <script src="js/logout.js"></script>
</body>

</html>